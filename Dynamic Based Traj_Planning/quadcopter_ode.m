function dx = quadcopter_ode(t,x,u,p,w)
    kb=3.830471037572471e-06;
    m=1.3;
    Ix=0.081;
    Iy=0.081;
    Iz=0.142;
    kt=2.251838161212916e-08;
    l=0.174;
    
    T=x(13)^2+x(14)^2+x(15)^2+x(16)^2;
%     dx(1)=x(2);
%     dx(2)=kb/m*(sin(x(7))*sin(x(11))+cos(x(7))*cos(x(11))*sin(x(9)))*T;
%     dx(3)=x(4);
%     dx(4)=kb/m*(cos(x(7))*sin(x(9))*sin(x(11))-cos(x(11))*sin(x(7)))*T;
%     dx(5)=x(6);
%     dx(6)=kb/m*(cos(x(9))*cos(x(7)))*T-g;
%     dx(7)=x(8);
%     dx(8)=(Iy-Iz)/Ix*x(10)*x(12)+l*kb/Ix*(x(14)^2-x(16)^2)-J/Ix*x(10)*(x(13)-x(14)+x(15)-x(16));
%     dx(9)=x(10);
%     dx(10)=(Iz-Ix)/Iy*x(8)*x(12)+l*kb/Iy*(x(15)^2-x(13)^2)+J/Iy*x(8)*(x(13)-x(14)+x(15)-x(16));
%     dx(11)=x(12);
%     dx(12)=(Ix-Iy)/Iz*x(8)*x(10)+kt/Iz*(x(13)^2-x(14)^2+x(15)^2-x(16)^2);
%     dx(13)=u(1);
%     dx(14)=u(2);
%     dx(15)=u(3);
%     dx(16)=u(4);
    dx(1)=x(2);
    dx(2)=kb/m*(x(7)*sin(x(11))+cos(x(11))*x(9))*T;
    dx(3)=x(4);
    dx(4)=kb/m*(x(9)*sin(x(11))-cos(x(11))*x(7))*T;
    dx(5)=x(6);
    dx(6)=kb/m*T-g;
    dx(7)=x(8);
    dx(8)=(Iy-Iz)/Ix*x(10)*x(12)+l*kb/Ix*(x(14)^2-x(16)^2)-J/Ix*x(10)*(x(13)-x(14)+x(15)-x(16));
    dx(9)=x(10);
    dx(10)=(Iz-Ix)/Iy*x(8)*x(12)+l*kb/Iy*(x(15)^2-x(13)^2)+J/Iy*x(8)*(x(13)-x(14)+x(15)-x(16));
    dx(11)=x(12);
    dx(12)=(Ix-Iy)/Iz*x(8)*x(10)+kt/Iz*(x(13)^2-x(14)^2+x(15)^2-x(16)^2);
    dx(13)=u(1);
    dx(14)=u(2);
    dx(15)=u(3);
    dx(16)=u(4);
    
end